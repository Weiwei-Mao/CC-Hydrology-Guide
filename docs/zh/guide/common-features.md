# 02 - 常用功能

[English](02-Common-Features.md) | **简体中文**

[← 返回首页](../README-zh.md)

## 目录

1. [代码编写与调试](#代码编写与调试)
2. [文件操作](#文件操作)
3. [数据分析基础](#数据分析基础)
4. [可视化绘图](#可视化绘图)
5. [代码理解与重构](#代码理解与重构)

---

## 代码编写与调试

### 让 AI 写代码

Claude Code 最核心的功能是帮你写代码。你只需要用自然语言描述需求：

```
请用 Python 写一个函数，计算皮尔逊相关系数
```

Claude 会：
1. 编写完整的函数代码
2. 添加必要的注释
3. 可能包含使用示例

### 代码调试

当代码出现问题时，直接把错误信息告诉 Claude：

```
我的代码报错了：NameError: name 'pd' is not defined
```

Claude 会帮你：
- 分析错误原因
- 提供修复方案
- 解释为什么会出现这个错误

### 代码优化

如果你有现成的代码但觉得不够好：

```
帮我优化这段代码，让它运行更快
```

然后粘贴你的代码，Claude 会提供优化建议。

### 完整示例

**你的输入：**
```
我需要分析一个水文站的日流量数据。请帮我：
1. 读取名为 daily_flow.csv 的文件
2. 计算年平均流量
3. 找出最大流量和最小流量的日期
4. 画出流量过程线图
```

**Claude 会做的事情：**
1. 创建一个 Python 脚本文件（如 `analyze_flow.py`）
2. 写入完整的分析代码
3. 告诉你如何运行这个脚本

---

## 文件操作

### 读取文件

你可以让 Claude 读取并分析文件内容：

```
请读取 data.csv 文件，告诉我它包含哪些列
```

或者更具体：

```
读取 rainfall.csv，告诉我：
1. 数据的时间范围
2. 有多少行数据
3. 每一列的含义
```

### 创建文件

```
创建一个新的 Python 脚本，名为 process_data.py
```

```
创建一个 Markdown 文件，记录今天的分析结果
```

### 编辑文件

```
请在 analyze.py 中添加一个函数，用于计算标准差
```

```
修改 plot.py 中的图表标题为 "2023年水位变化"
```

### 搜索代码

```
在项目中搜索所有包含 "correlation" 的代码
```

```
找出所有读取 CSV 文件的代码位置
```

---

## 数据分析基础

### 读取数据文件

水文研究中常用 CSV、Excel 格式的数据。让 Claude 帮你读取：

```
用 pandas 读取 hydro_data.csv，第一列是日期
```

```
读取 Excel 文件 water_quality.xlsx，只读取 "2023年" 这个工作表
```

### 数据清洗

```
检查数据中是否有缺失值，如果有就删除
```

```
将日期列转换为 datetime 格式，并设为索引
```

```
去除流量为负数的异常数据
```

### 基础统计

```
计算降雨量的平均值、标准差、最大值、最小值
```

```
计算每年总径流量
```

```
统计每个月的平均水位
```

### 数据筛选

```
筛选出汛期（6-9月）的数据
```

```
找出流量超过 1000 m³/s 的所有日期
```

```
获取 2023 年的完整数据
```

---

## 可视化绘图

### 基础绘图

```
用 matplotlib 画出水位随时间的变化曲线
```

```
画出降雨-径流散点图
```

### 图表美化

```
优化这张图：
- 添加中文标题
- 设置合适的字体
- 调整坐标轴标签
- 添加图例
```

### 多图布局

```
创建一个 2x2 的子图布局：
左上：降雨量过程线
右上：水位过程线
左下：流量过程线
右下：水位-流量关系曲线
```

### 保存图表

```
将当前图表保存为高分辨率 PNG，用于论文
```

```
保存为 PDF 格式，分辨率 300 dpi
```

### 完整示例

```
创建一个水文过程线图，要求：
1. X 轴为日期（2023-01-01 到 2023-12-31）
2. 左 Y 轴为降雨量（柱状图，蓝色）
3. 右 Y 轴为流量（折线图，红色）
4. 添加图例、标题、坐标轴标签
5. 使用中文字体
6. 保存为 rainfall_runoff_2023.png
```

---

## 代码理解与重构

### 理解别人的代码

当你拿到别人的代码看不懂时：

```
请解释这段代码在做什么
```

然后粘贴代码，Claude 会：
- 逐行解释代码功能
- 说明整体逻辑
- 指出关键部分

### 代码重构

```
这段代码很长且难以维护，请帮我重构得更清晰
```

Claude 会：
- 将长函数拆分成小函数
- 添加有意义的变量名
- 添加注释说明
- 遵循最佳实践

### 添加文档

```
为这个函数添加详细的文档字符串，包括：
- 功能描述
- 参数说明
- 返回值说明
- 使用示例
```

### 代码转换

```
将这段 MATLAB 代码转换为 Python 代码
```

```
将 R 语言的 ggplot 代码转换为 Python matplotlib
```

---

## 实用技巧

### 1. 保存常用代码片段

如果你经常做某种分析，可以让 Claude 创建模板：

```
创建一个 Python 模板，包含常用的数据分析步骤：
1. 导入必要的库
2. 读取 CSV 数据
3. 基本统计信息
4. 时间序列可视化
保存为 analysis_template.py
```

### 2. 批量处理

```
帮我写一个脚本，批量处理 data 文件夹下的所有 CSV 文件，
对每个文件计算统计量，并将结果保存到一个汇总文件
```

### 3. 创建报告

```
根据分析结果，生成一份 Markdown 格式的分析报告，
包括数据概况、统计摘要、图表说明
```

### 4. 代码版本控制

```
帮我创建一个 .gitignore 文件，排除 Python 的常见文件
```

```
生成一条 Git 提交信息，描述我刚才的修改
```

---

## 常见错误处理

### 导入错误

```
ModuleNotFoundError: No module named 'pandas'
```

**解决方案**：告诉 Claude，它会给你安装命令：
```bash
pip install pandas
```

### 文件路径错误

```
FileNotFoundError: data.csv
```

**解决方案**：检查文件名和路径是否正确，或使用绝对路径。

### 编码问题

中文数据常遇到编码问题：

```
读取 CSV 时遇到编码错误
```

**解决方案**：Claude 会建议尝试不同的编码（如 `encoding='gbk'` 或 `encoding='utf-8'`）

---

## 下一步

现在你已经掌握了 Claude Code 的常用功能，接下来可以：

- 阅读 [03-水文场景案例](03-水文场景案例.md) 学习水文研究的具体应用
- 阅读 [04-进阶技巧](04-进阶技巧.md) 了解更高级的功能
- 尝试用你自己的数据进行练习

---

[← 上一章：01-基础入门](01-基础入门.md) | [下一章：03-水文场景案例 →](03-水文场景案例.md)
